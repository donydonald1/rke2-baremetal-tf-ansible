apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
    name: grafana-user-secret
spec:
    refreshInterval: 1h
    secretStoreRef:
        kind: ClusterSecretStore
        name: vault
    target:
        name: gitlab-initial-root-password
        creationPolicy: Owner
        template:
            metadata:
                labels:
                    cnpg.io/reload: ""
    data:
      - secretKey: password
        remoteRef:
            key: secret/gitlab/
            property: gitlab-initial-root-password
---
# apiVersion: v1
# data:
#     password: TldSalpHUTBZMkkyWWpGaU1ERmpOakZrWlRNM1kySXpZbVEzTldNM1pqUUs=
#     postgres-password: WVdWbVlXUTNOVE0wT0RRMFlXSXhORFl5WVdNeFpETm1NREkwTUdWaVlqa0s=
#     repmgr-password: TTJVNE1XSTBaREV4T1RnelpXSTFaRFUxWXpoaVlXUmtPR0V5TkRNMU9EQUs=
#     admin-password: TldSalpHUTBZMkkyWWpGaU1ERmpOakZrWlRNM1kySXpZbVEzTldNM1pqUUs=
# kind: Secret
# metadata:
#     name: postgresql-secret
#     namespace: gitlab
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
    name: postgresql-secret
spec:
    refreshInterval: 1h
    secretStoreRef:
        kind: ClusterSecretStore
        name: vault
    target:
        name: postgresql-secret
        creationPolicy: Owner
        template:
            metadata:
                labels:
                    cnpg.io/reload: ""
    data:
      - secretKey: username
        remoteRef:
            key: secret/gitlab/
            property: dbusername
      - secretKey: password
        remoteRef:
            key: secret/gitlab/
            property: dbpassword
---
apiVersion: v1
data:
    password: TldSalpHUTBZMkkyWWpGaU1ERmpOakZrWlRNM1kySXpZbVEzTldNM1pqUUs=
    postgres-password: WVdWbVlXUTNOVE0wT0RRMFlXSXhORFl5WVdNeFpETm1NREkwTUdWaVlqa0s=
    repmgr-password: TTJVNE1XSTBaREV4T1RnelpXSTFaRFUxWXpoaVlXUmtPR0V5TkRNMU9EQUs=
    admin-password: TldSalpHUTBZMkkyWWpGaU1ERmpOakZrWlRNM1kySXpZbVEzTldNM1pqUUs=
kind: Secret
metadata:
    name: repmgr-secret
    namespace: gitlab
---
apiVersion: v1
data:
    password: TldSalpHUTBZMkkyWWpGaU1ERmpOakZrWlRNM1kySXpZbVEzTldNM1pqUUs=
    postgres-password: WVdWbVlXUTNOVE0wT0RRMFlXSXhORFl5WVdNeFpETm1NREkwTUdWaVlqa0s=
    repmgr-password: TTJVNE1XSTBaREV4T1RnelpXSTFaRFUxWXpoaVlXUmtPR0V5TkRNMU9EQUs=
    admin-password: TldSalpHUTBZMkkyWWpGaU1ERmpOakZrWlRNM1kySXpZbVEzTldNM1pqUUs=
kind: Secret
metadata:
    name: pgpool-secret
    namespace: gitlab